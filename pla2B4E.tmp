[gd_scene load_steps=31 format=3 uid="uid://csg8wjf6a5aob"]

[ext_resource type="Script" path="res://Scripts/PlayerScript.gd" id="1_ipmmu"]
[ext_resource type="PackedScene" uid="uid://cyu4ar4mkpere" path="res://Components/animation_controller.tscn" id="2_3at6a"]
[ext_resource type="Script" path="res://addons/godot_state_charts/state_chart.gd" id="4_2yo3l"]
[ext_resource type="PackedScene" uid="uid://bp688eqcgfjwd" path="res://Components/HealthComp/health_component.tscn" id="4_baop4"]
[ext_resource type="Texture2D" uid="uid://bfycox044y4cg" path="res://ShrimpVer3.png" id="4_n1xjb"]
[ext_resource type="Script" path="res://addons/godot_state_charts/parallel_state.gd" id="5_at1br"]
[ext_resource type="PackedScene" uid="uid://c7xwwqj0hapij" path="res://Components/AttackComp/attack_component.tscn" id="5_ucs2o"]
[ext_resource type="Script" path="res://addons/godot_state_charts/compound_state.gd" id="6_hn4k0"]
[ext_resource type="Script" path="res://Components/AttackComp/attack_component.gd" id="6_l0v47"]
[ext_resource type="Script" path="res://addons/godot_state_charts/atomic_state.gd" id="7_dstdp"]
[ext_resource type="Script" path="res://addons/godot_state_charts/transition.gd" id="8_42be4"]
[ext_resource type="Script" path="res://addons/godot_state_charts/expression_guard.gd" id="9_68rkj"]
[ext_resource type="Script" path="res://addons/godot_state_charts/state_is_active_guard.gd" id="10_rraxh"]
[ext_resource type="PackedScene" uid="uid://cdsxjfv24t6l1" path="res://Components/Input Component/PlayerInputComp.tscn" id="11_xu1wv"]
[ext_resource type="PackedScene" uid="uid://bkqlik2fxo66g" path="res://Components/Velocity/VelocityComp.tscn" id="12_5gsum"]
[ext_resource type="Script" path="res://Components/Uppgrades/upgrades_component_Handler.gd" id="16_11q3e"]
[ext_resource type="Script" path="res://Components/Uppgrades/Dash_Uppgrade.gd" id="17_1yrgc"]

[sub_resource type="CapsuleShape2D" id="CapsuleShape2D_04st2"]
radius = 35.0
height = 80.0

[sub_resource type="Resource" id="Resource_fid6i"]
script = ExtResource("9_68rkj")
expression = "is_on_floor() == true"

[sub_resource type="Resource" id="Resource_1r54w"]
script = ExtResource("10_rraxh")
state = NodePath("../../../StateCheck/Airborne")

[sub_resource type="RectangleShape2D" id="RectangleShape2D_rqy0m"]
size = Vector2(80, 50.5)

[sub_resource type="Animation" id="Animation_xp50w"]
resource_name = "Falling"
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("../PlayerBody:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [25]
}

[sub_resource type="Animation" id="Animation_ak2ki"]
length = 0.5
loop_mode = 1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("../PlayerBody:visible")
tracks/0/interp = 1
tracks/0/loop_wrap = false
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [true]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("../PlayerBody:frame")
tracks/1/interp = 1
tracks/1/loop_wrap = false
tracks/1/keys = {
"times": PackedFloat32Array(0, 0.1, 0.2, 0.3, 0.4),
"transitions": PackedFloat32Array(1, 1, 1, 1, 1),
"update": 1,
"values": [0, 1, 2, 3, 0]
}

[sub_resource type="Animation" id="Animation_vqwim"]
length = 0.171
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("../PlayerBody:visible")
tracks/0/interp = 1
tracks/0/loop_wrap = false
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [true]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("../PlayerBody:frame")
tracks/1/interp = 1
tracks/1/loop_wrap = false
tracks/1/keys = {
"times": PackedFloat32Array(0, 0.101574),
"transitions": PackedFloat32Array(1, 1),
"update": 0,
"values": [23, 24]
}

[sub_resource type="Animation" id="Animation_f4yhp"]
resource_name = "Landing"
length = 0.203
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("../PlayerBody:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.1),
"transitions": PackedFloat32Array(1, 1),
"update": 1,
"values": [22, 21]
}

[sub_resource type="Animation" id="Animation_rrp8r"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("../PlayerBody:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [23]
}

[sub_resource type="Animation" id="Animation_bkops"]
length = 0.6
loop_mode = 1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("../PlayerBody:visible")
tracks/0/interp = 1
tracks/0/loop_wrap = false
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [true]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("../PlayerBody:frame")
tracks/1/interp = 1
tracks/1/loop_wrap = false
tracks/1/keys = {
"times": PackedFloat32Array(0, 0.05, 0.1, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55),
"transitions": PackedFloat32Array(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1),
"update": 1,
"values": [6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17]
}

[sub_resource type="Animation" id="Animation_b4fsm"]
length = 0.16
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("../PlayerBody:visible")
tracks/0/interp = 1
tracks/0/loop_wrap = false
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [true]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("../PlayerBody:frame")
tracks/1/interp = 1
tracks/1/loop_wrap = false
tracks/1/keys = {
"times": PackedFloat32Array(0, 0.0333333, 0.0666667, 0.1, 0.133333),
"transitions": PackedFloat32Array(1, 1, 1, 1, 1),
"update": 1,
"values": [0, 1, 2, 4, 5]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_o2oaf"]
_data = {
"Falling": SubResource("Animation_xp50w"),
"Idle Right": SubResource("Animation_ak2ki"),
"Jump": SubResource("Animation_vqwim"),
"Landing": SubResource("Animation_f4yhp"),
"RESET": SubResource("Animation_rrp8r"),
"Run": SubResource("Animation_bkops"),
"idleToRun": SubResource("Animation_b4fsm")
}

[sub_resource type="CapsuleShape2D" id="CapsuleShape2D_js7ix"]
radius = 29.0
height = 80.0

[node name="Player" type="CharacterBody2D" node_paths=PackedStringArray("InputNode", "VelocityNode", "BodySprite", "HealthNode", "PowHandler")]
script = ExtResource("1_ipmmu")
InputNode = NodePath("PlayerInputComp")
VelocityNode = NodePath("VelocityComp")
BodySprite = NodePath("PlayerBody")
HealthNode = NodePath("HealthComponent")
PowHandler = NodePath("UpgradesComponent")

[node name="Collider" type="CollisionShape2D" parent="."]
position = Vector2(0, 11)
shape = SubResource("CapsuleShape2D_04st2")

[node name="AnimationController" parent="." node_paths=PackedStringArray("CharSprite", "CharBody", "AnimPlayer", "VelComp") instance=ExtResource("2_3at6a")]
CharSprite = NodePath("../PlayerBody")
CharBody = NodePath("..")
AnimPlayer = NodePath("../PlayerAnim")
VelComp = NodePath("../VelocityComp")

[node name="HealthComponent" parent="." node_paths=PackedStringArray("Entity", "Hurt_Box") groups=["Player"] instance=ExtResource("4_baop4")]
Health = 4.0
Max_Health = 4.0
Entity = NodePath("..")
Hurt_Box = NodePath("../HurtBox")

[node name="Camera2D" type="Camera2D" parent="."]
position = Vector2(-9.53674e-07, -157)
scale = Vector2(0.807275, 0.859156)
zoom = Vector2(1.225, 1.225)
drag_horizontal_enabled = true
drag_vertical_enabled = true
drag_top_margin = 0.41
drag_bottom_margin = 0.0
editor_draw_limits = true
editor_draw_drag_margin = true

[node name="StateChart" type="Node" parent="."]
script = ExtResource("4_2yo3l")

[node name="Root" type="Node" parent="StateChart"]
script = ExtResource("5_at1br")

[node name="StateCheck" type="Node" parent="StateChart/Root"]
script = ExtResource("6_hn4k0")
initial_state = NodePath("Grounded")

[node name="Grounded" type="Node" parent="StateChart/Root/StateCheck"]
script = ExtResource("7_dstdp")

[node name="Jumped" type="Node" parent="StateChart/Root/StateCheck/Grounded"]
script = ExtResource("8_42be4")
to = NodePath("../../Airborne")
event = &"Jump_state"
delay_in_seconds = "0.0"

[node name="Fall" type="Node" parent="StateChart/Root/StateCheck/Grounded"]
script = ExtResource("8_42be4")
to = NodePath("../../Airborne")
event = &"Fall_state"
delay_in_seconds = "0.0"

[node name="Airborne" type="Node" parent="StateChart/Root/StateCheck"]
script = ExtResource("7_dstdp")

[node name="Falling" type="Node" parent="StateChart/Root/StateCheck/Airborne"]
script = ExtResource("8_42be4")
to = NodePath("../../Grounded")
guard = SubResource("Resource_fid6i")
delay_in_seconds = "0.0"

[node name="AnimationStates" type="Node" parent="StateChart/Root"]
script = ExtResource("6_hn4k0")
initial_state = NodePath("Idle")

[node name="Idle" type="Node" parent="StateChart/Root/AnimationStates"]
script = ExtResource("7_dstdp")

[node name="To Running" type="Node" parent="StateChart/Root/AnimationStates/Idle"]
script = ExtResource("8_42be4")
to = NodePath("../../Running")
event = &"Moving"
delay_in_seconds = "0.0"

[node name="Jump" type="Node" parent="StateChart/Root/AnimationStates/Idle"]
script = ExtResource("8_42be4")
to = NodePath("../../Jumping")
event = &"Jumping"
delay_in_seconds = "0.0"

[node name="Running" type="Node" parent="StateChart/Root/AnimationStates"]
script = ExtResource("7_dstdp")

[node name="To Idle" type="Node" parent="StateChart/Root/AnimationStates/Running"]
script = ExtResource("8_42be4")
to = NodePath("../../Idle")
event = &"Not_Moving"
delay_in_seconds = "0.0"

[node name="Jump" type="Node" parent="StateChart/Root/AnimationStates/Running"]
script = ExtResource("8_42be4")
to = NodePath("../../Jumping")
event = &"Jumping"
delay_in_seconds = "0.0"

[node name="Jumping" type="Node" parent="StateChart/Root/AnimationStates"]
script = ExtResource("7_dstdp")

[node name="still moving" type="Node" parent="StateChart/Root/AnimationStates/Jumping"]
script = ExtResource("8_42be4")
to = NodePath("../../Running")
event = &"Moving"
guard = SubResource("Resource_1r54w")
delay_in_seconds = "0.0"

[node name="Not moving" type="Node" parent="StateChart/Root/AnimationStates/Jumping"]
script = ExtResource("8_42be4")
to = NodePath("../../Idle")
event = &"Not_Moving"
delay_in_seconds = "0.0"

[node name="PlayerInputComp" parent="." node_paths=PackedStringArray("AttackComp", "PowHandler") instance=ExtResource("11_xu1wv")]
AttackComp = NodePath("../AttackComponent")
PowHandler = NodePath("../UpgradesComponent")

[node name="VelocityComp" parent="." node_paths=PackedStringArray("CharBody", "InputNode", "AnimCtrl") instance=ExtResource("12_5gsum")]
JUMP_FORCE = -620.0
CharBody = NodePath("..")
InputNode = NodePath("../PlayerInputComp")
AnimCtrl = NodePath("../AnimationController")
metadata/_edit_group_ = true

[node name="AttackComponent" parent="." node_paths=PackedStringArray("Hit_Box") instance=ExtResource("5_ucs2o")]
script = ExtResource("6_l0v47")
Hit_Box = [NodePath("../Attack right"), NodePath("../Attack Left")]

[node name="Attack Left" type="Area2D" parent="."]
position = Vector2(5, 0)

[node name="AttackCollider" type="CollisionShape2D" parent="Attack Left"]
position = Vector2(-86, 18)
shape = SubResource("RectangleShape2D_rqy0m")
disabled = true
debug_color = Color(0.909536, 0.248171, 0.428549, 0.42)

[node name="Attack right" type="Area2D" parent="."]
position = Vector2(3, -1)

[node name="AttackCollider" type="CollisionShape2D" parent="Attack right"]
position = Vector2(77, 18)
shape = SubResource("RectangleShape2D_rqy0m")
disabled = true
debug_color = Color(0.909536, 0.248171, 0.428549, 0.42)

[node name="PlayerBody" type="Sprite2D" parent="."]
texture_filter = 1
scale = Vector2(2, 2)
texture = ExtResource("4_n1xjb")
hframes = 6
vframes = 5
frame = 23
metadata/_aseprite_wizard_config_ = {
"i_mode": -1,
"keep_anim_length": true,
"layer": "",
"o_ex_p": "",
"o_folder": "",
"o_name": "",
"only_visible": true,
"player": "AnimationController/PlayerAnim",
"set_vis_track": true,
"slice": "",
"source": "res://Aseprite Files/Shrim Frames/ShrimpVer3.aseprite"
}
metadata/_aseprite_wizard_interface_config_ = {
"animation_section": false,
"layer_section": false,
"output_section": true,
"slice_section": false
}
metadata/_aseprite_wizard_source_file_hash_ = "24e4c6c3163ab4b6669804c59e8db0dc"

[node name="PlayerAnim" type="AnimationPlayer" parent="."]
root_node = NodePath("../AnimationController")
libraries = {
"": SubResource("AnimationLibrary_o2oaf")
}

[node name="HurtBox" type="Area2D" parent="."]

[node name="HurtBoxCollider" type="CollisionShape2D" parent="HurtBox"]
position = Vector2(0, 11)
shape = SubResource("CapsuleShape2D_js7ix")

[node name="UpgradesComponent" type="Node" parent="." node_paths=PackedStringArray("InputComp", "DashUpgrade")]
unique_name_in_owner = true
script = ExtResource("16_11q3e")
InputComp = NodePath("../PlayerInputComp")
DashUpgrade = NodePath("Dash")

[node name="Dash" type="Node" parent="UpgradesComponent" node_paths=PackedStringArray("VelComp", "InputComp", "Player")]
script = ExtResource("17_1yrgc")
VelComp = NodePath("../../VelocityComp")
InputComp = NodePath("../../PlayerInputComp")
Player = NodePath("../..")
DashMod = 200

[connection signal="Flipped" from="." to="AttackComponent" method="_on_player_flipped"]
[connection signal="Not_Flipped" from="." to="AttackComponent" method="_on_player_not_flipped"]
[connection signal="took_Damage" from="HealthComponent" to="AnimationController" method="_on_health_component_took_damage"]
[connection signal="Ascending" from="VelocityComp" to="AnimationController" method="_on_velocity_comp_ascending"]
[connection signal="Dash" from="VelocityComp" to="UpgradesComponent/Dash" method="_on_velocity_comp_dash"]
[connection signal="Falling" from="VelocityComp" to="AnimationController" method="_on_velocity_comp_falling"]
[connection signal="Grounded" from="VelocityComp" to="AnimationController" method="_on_velocity_comp_grounded"]
[connection signal="Idle" from="VelocityComp" to="AnimationController" method="_on_velocity_comp_idle"]
[connection signal="Running" from="VelocityComp" to="AnimationController" method="_on_velocity_comp_running"]
[connection signal="UpgradePickup" from="UpgradesComponent" to="UpgradesComponent/Dash" method="_on_upgrades_component_upgrade_pickup"]
